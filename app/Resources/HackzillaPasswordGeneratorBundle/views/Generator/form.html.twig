{% block form %}
    {{ form_start(form) }}
    {{ form_errors(form) }}
    {{ form_rest(form) }}

    {# OCULTANDO CAMPO "NUMERO DE CONTRASEÃ‘AS", POR DEFECTO SE CREA UNA SOLA #}
    <script>
        var labels = document.getElementsByTagName('label');
        for (var i = 0; i < labels.length; i++) {
            labels[i].style.paddingRight = "15px";
            var attr = labels[i].getAttribute('for');
            if (attr === 'quantity') {
                labels[i].style.display = 'none';
            }
        }
        document.getElementById('quantity').style.display = 'none';
        document.getElementById('quantity').setAttribute("value", "1");
    </script>

    
    <script>
        // GENERANDO PASS
        $(document).ready(function () {
            // process the form
            $('#form').submit(function (event) {
                // get the form data
                // there are many ways to get this data using jQuery (you can use the class or id also)
                var formData = {
                    'quantity': $('input[name=quantity]').val(),
                    'uppercase': $('input[name=uppercase]').val(),
                    'lowercase': $('input[name=lowercase]').val(),
                    'numbers': $('input[name=numbers]').val(),
                    'avoid_similar': $('input[name=avoid_similar]').val(),
                    'segment_count': $('input[name=segment_count]').val(),
                    'segment_length': $('input[name=segment_length]').val()
                };

                for (i in formData){
                    alert(formData[i].toString());
                }
                // process the form
                $.ajax({
                    type: 'POST', // define the type of HTTP verb we want to use (POST for our form)
                    url: 'http://www.passmanager/app_dev.php/sonata/user/password/create', // the url where we want to POST
                    data: formData, // our data object
                    dataType: 'json', // what type of data do we expect back from the server
                    encode: true,
                    success: function (msg) {
                        $("#thanks").html(msg), //hide button and show thank you
                                $("#form-content").modal('hide'); //hide popup  
                    },
                    error: function () {
                        alert("failure");
                    }
                })
                        // using the done promise callback
                        .done(function (data) {
                            // log data to the console so we can see
                            console.log(data);
                            // here we will handle errors and validation messages
                        });
                // stop the form from submitting the normal way and refreshing the page
                event.preventDefault();
            });
        });
    </script>

    <div class="passwords modal-body">
        <h4>{{ "HEADING_PASSWORDS"|trans }}</h4>
        <div>
            ------------------------------------
            <ul>
                {% for password in passwords -%}
                    <li>{{ password }}</li>
                    {% endfor %}
            </ul>
        </div>
        ------------------------------------
    </div>

    <div class="modal-footer actions">
        <input type="submit" class="btn btn-success" value="{{ 'BUTTON_GENERATE'|trans }}">
        <input type="reset" class="btn btn-danger" value="{{ 'BUTTON_RESET'|trans }}">       
    </div>
    {{ form_end(form) }}

    {% if error %}
        <div class="alert alert-warning" role="alert">
            <strong>{{ 'ERROR_HEADING'|trans }}</strong>&nbsp;

            {%- if error == 'CharactersNotFoundException' %}
            {{ 'ERROR_CHARACTERS_NOT_FOUND_EXCEPTION'|trans }}.
        {% else %}
            {{ 'ERROR_UNKNOWN'|trans }}.
        {% endif -%}
    </div>
    {% endif %}
{% endblock form %}
